{% extends 'base.html' %}

{% block title %}{{ movie.Title }}{% endblock %}

{% block content %}
<style>
    footer{display:none;line-height:1.9;}
  body {background-color:black; color:white;}
  .movie-detail-container {
      display: flex;      
      align-items: flex-start;
      justify-content: center;
      flex-wrap: wrap;
      gap: 30px;
      padding: 30px;
  }
  
  .movie-detail-container img {
      width: 300px;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
  }
  
  .details {
    padding:20px;
    border:0px solid black; border-radius:5px;
    background-color:black;
      max-width: 600px;
      font-family: Arial, sans-serif;
  }
  
  .details h1 {
      font-size: 28px;
      margin-bottom: 10px;
  }
  
  .details p {
      margin: 6px 0;
      line-height: 1.6;
  }
  
  .back-link {
      text-decoration: none;
      color: white;
      background-color: #007BFF;
      padding: 8px 15px;
      border-radius: 6px;
  }
  
  .back-link:hover {
      background-color: #0056b3;
  }
  h2 {margin:5px;}
  iframe {
    width: 700px;
    height: 400px;
    border-radius: 10px;
    margin-top: 20px;
    border: none;
}
.trailer { text-align:center;}
.trailer h2 {padding:7px; width:150px; border:0px solid black; background-color:black; border-radius:10px;}
.list_review {margin:10px; padding: 5px; border-radius:8px; background-color:#121212; color:white;}
.list_review a{ text-decoration:none; color:white; text-align:center; font-size:20px;}
.list_review h2 {background-color:white; color:darkgreen; width: 200px; border-radius:10px; padding:5px;}
.list_review button{background-color:darkred; border:none; border-radius:10px; padding: 5px; margin-left: 10px;}
.review-card {
    display:flex;
    background: black;
    padding: 10px;
    border:1px solid white;
    margin-bottom: 15px;
    border-radius: 8px;
    color: white;
}
.list_review .Edit-btn {background-color:green;}
.review-card p{padding:5px; border-radius:5px; color: white;}
.btn a{color:white;}
.btn {margin:10px; background-color:darkred; color:white;}
.btn:hover {background-color:red;}

  </style>

<div class="movie-detail-container">
    <img src="{{ movie.Poster }}" alt="{{ movie.Title }}" width="250">
    <div class="details">
      <h1>{{ movie.Title }}</h1>
      <p><strong>Year:</strong> {{ movie.Year }}</p>
      <p><strong>Genre:</strong> {{ movie.Genre }}</p>
      <p><strong>Director:</strong> {{ movie.Director }}</p>
      <p><strong>Plot:</strong> {{ movie.Plot }}</p>
      <p><strong>IMDb Rating:</strong> {{ movie.imdbRating }}</p>
    </div>
</div>

<div class="trailer">
      <h2>Watch Trailer</h2>
      {% if trailer %}
    <iframe width="560" height="315"
        src="https://www.youtube.com/embed/{{ trailer }}"
        frameborder="0"
        allowfullscreen></iframe>
{% else %}
    <p>No trailer found ðŸ˜¢</p>
{% endif %}
</div>

<div class='list_review'>
      <a href="{% url 'add_review' movie.imdbID movie.Title %}">Click to add a Review</a>
        <hr>
        <h2>Users Reviews</h2>
        
        {% if reviews %}
            {% for review in reviews %}
                <div class="review-card">
                    <p><strong>{{ review.user.username }}</strong> rated it {{ review.rating }}/5</p> <br>
                    <br>
                    <p>{{ review.comment }}</p>
                    <small>Posted on {{ review.created_at|date:"M d, Y H:i" }}</small>
                    <p>{{ review.content}}</p>

        {% if review.user == request.user %}
            <p class="edit-delete">
                <button class='Edit-btn'><a href="{% url 'edit_review' review.pk %}">Edit</a> </button>
               <button> <a href="{% url 'delete_review' review.pk %}">Delete</a></button>
            </p>
        {% endif %}

        </div>
        <hr>
        {% endfor %}
        {% else %}
            <p>No reviews yet. Be the first to <a href="{% url 'add_review' movie.imdbID movie.Title %}">write one</a>!</p>
        {% endif %}
        
    </div>
{% endblock %}
